sqlplus "/" as sysdba

grant all privileges to knu;

conn knu/comp322;

DROP TABLE DEPARTMENT CASCADE CONSTRAINT;

CREATE TABLE EMPLOYEE(
	Fname	VARCHAR(15)	NOT NULL,
	Minit	CHAR,
	Lname	VARCHAR(15),
	Ssn	CHAR(9),
	Bdate	DATE,
	Address	VARCHAR(30),
	Sex	CHAR,
	Salary	NUMBER(10,2),
	Super_ssn	CHAR(9),
	Dno	NUMBER DEFAULT 1 NOT NULL,
	PRIMARY KEY	(Ssn)
);

CREATE TABLE DEPARTMENT(
	Dname	VARCHAR(15)	NOT NULL,
	Dnumber	NUMBER		NOT NULL,
	Mgr_ssn	CHAR(9)		DEFAULT '888665555' NOT NULL,
	Mgr_start_date		DATE,
	PRIMARY KEY	(Dnumber),
	UNIQUE	(Dname),
	FORIEIGN KEY (Mgr_ssn) REFERENCES EMPLOYEE(Ssn)
);

CREATE TABLE DEPT_LOCATIONS(
	Dnumber		NUMBER		NOT NULL,
	Dlocation		VARCHAR(15)	NOT NULL,
	PRIMARY KEY	(Dnumber, Dlocation),
	FOREIGN KEY	(Dnumber) REFERENCES DEPARTMENT(Dnumber)
);

CREATE TABLE PROJECT(
	Pname		VARCHAR(15)	NOT NULL,
	Pnumber		NUMBER		NOT NULL,
	Plocation		VARCHAR(15),
	Dnum		NUMBER 		NOT NULL,
	PRIMARY KEY	(Pnumber),
	UNIQUE	(Pname),
	FORIEIGN KEY (Dnum) REFERENCES DEPARTMENT(Dnumber)
);

CREATE TABLE WORKS_ON(
	Essn	CHAR(9)		NOT NULL,
	Pno	NUMBER		NOT NULL,
	Hours	DECIMAL(3,1),
	PRIMARY KEY	(Essn, Pno),
	FOREIGN KEY	(Essn) REFERENCES EMPLOYEE(Ssn),
	FOREIGN KEY	(Pno) REFERENCES PROJECT(Pnumber)
);

-- Add
ALTER TABLE DEPARTMENT ADD FOREIGN KEY (Mgr_ssn) REFERENCES EMPLOYEE(Ssn) ON DELETE SET NULL;
ALTER TABLE EMPLOYEE ADD FOREIGN KEY (Super_ssn) REFERENCES EMPLOYTEE(Ssn) ON DELETE SET NULL;

-- Insert
INSET INTO DEPT_LOCATIONS VALUES (1, 'Houston');
INSET INTO DEPT_LOCATIONS VALUES (4, 'Stafford');
INSET INTO DEPT_LOCATIONS VALUES (5, 'Bellaire');
INSET INTO DEPT_LOCATIONS VALUES (5, 'Houston');
INSET INTO DEPT_LOCATIONS VALUES (5, 'Sugarland');

INSERT INTO WORKS_ON VALUES ('123456789', 1, 32.5);
INSERT INTO WORKS_ON VALUES ('123456789', 2, 7.5);
INSERT INTO WORKS_ON VALUES ('123456789', 3, 40);
INSERT INTO WORKS_ON VALUES ('123456789', 1, 32.5);

** set default Orcle Áö¿ø X